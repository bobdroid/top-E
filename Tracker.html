<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="css.css">
</head>    
<body>
    <ul>
        <li><a href="index.html">Log uit</a></li>
        <li class="dropdown">
            <a href="javascript:void(0)" class="dropbtn">Historie</a>
            <div class="dropdown-content">
                <a href="historie/2024-08-01.html" class="historie-link" data-date="2024-08-01">2024-08-01</a>
                <a href="historie/2024-08-02.html" class="historie-link" data-date="2024-08-02">2024-08-02</a>
                <a href="historie/2024-08-03.html" class="historie-link" data-date="2024-08-03">2024-08-03</a>
                <a href="historie/2024-08-04.html" class="historie-link" data-date="2024-08-04">2024-08-04</a>
                <a href="historie/2024-08-05.html" class="historie-link" data-date="2024-08-05">2024-08-05</a>
                <a href="historie/2024-08-06.html" class="historie-link" data-date="2024-08-06">2024-08-06</a>
                <a href="historie/2024-08-07.html" class="historie-link" data-date="2024-08-07">2024-08-07</a>
                <a href="historie/2024-08-08.html" class="historie-link" data-date="2024-08-08">2024-08-08</a>
                <a href="historie/2024-08-09.html" class="historie-link" data-date="2024-08-09">2024-08-09</a>
                <a href="historie/2024-08-10.html" class="historie-link" data-date="2024-08-10">2024-08-10</a>
                <a href="historie/2024-08-11.html" class="historie-link" data-date="2024-08-11">2024-08-11</a>
                <a href="historie/2024-08-12.html" class="historie-link" data-date="2024-08-12">2024-08-12</a>
                <a href="historie/2024-08-13.html" class="historie-link" data-date="2024-08-13">2024-08-13</a>
                <a href="historie/2024-08-14.html" class="historie-link" data-date="2024-08-14">2024-08-14</a>
                <a href="historie/2024-08-15.html" class="historie-link" data-date="2024-08-15">2024-08-15</a>
            </div>
        <li><a href="opties.html" class="dropbtn">opties</a></li>
    </ul>
    
    <p class="hoeveelheidzegger">aantal:</p>

    <img src="img/profilepic.png" class="profilepicture">

    <label for="search" class="Invullenicon"> 
        <div>Voer hier in wat je hebt gegeten vandaag T-33:</div>
    </label>
    <p>&nbsp;</p>

    <div id="container" style="display: none;">
        <div class="search-container">
            <input type="text" id="search-1" class="search-box" list="suggestions" placeholder="Typ om te zoeken...">
            <datalist id="suggestions">
                <option value="Kipdijfiletstuk">
                <option value="kipvleugel">
                <option value="Cherry">
                <option value="Date">
                <option value="Elderberry">
                <option value="Fig">
                <option value="Grape">
                <option value="Honeydew">
            </datalist>
            <input type="number" id="hoeveelheid-1" class="hoeveelheidbox" placeholder="Hoeveelheid">
            <p id="valuedisplay-1" class="value-display"></p>
        </div>
    </div>
    
    <!-- Knop om inputvelden te kopiëren -->
    <button onclick="kopieerInputvelden()">Kopieer inputvelden</button>
    <!-- Knop om de gegevens te downloaden -->
    <button onclick="jamalaan()" id="downloadButton ">Download Gegevens</button>
    <button onclick="voegOptieToe()()">buhbuhbuh</button>

    <p id="totaal" class="totaalclass"></p>
    <p id="nodig" class="nodig"></p>
    
    <script>
        const suggestionData = {
            "Kipdijfiletstuk": 6,
            "kipvleugel": 20,
            "Cherry": 10,
            "Date": 15,
            "Elderberry": 20,
            "Fig": 25,
            "Grape": 30,
            "Honeydew": 35
        };

        let kopieTeller = 0; // Teller voor het bijhouden van het aantal kopieën
        let isFirstCloneAdded = false; // Flag om bij te houden of de eerste clone is toegevoegd

        // Functie om value display bij te werken
        function updateValueDisplay(searchInput, hoeveelheidInput, valueDisplay) {
            const zoekterm = searchInput.value.trim().toLowerCase();
            const hoeveelheid = parseInt(hoeveelheidInput.value.trim());

            let totaleWaarde = 0;

            if (zoekterm && hoeveelheid) {
                // Zoekterm matchen met suggestionData
                for (const item in suggestionData) {
                    if (item.toLowerCase().includes(zoekterm)) {
                        totaleWaarde += suggestionData[item] * hoeveelheid;
                    }
                }
            }

            valueDisplay.textContent = `${totaleWaarde} gram`;

            // Update ook het totaal onderaan de pagina
            updateTotalValueDisplay();
        }

        function generateHistoryLinks() {
            const dropdownContent = document.getElementById('dropdown-content');
            const historiePath = 'historie/'; // The path where historie files are located
            
            // Fetch the list of files from the server (assuming you have an endpoint that provides this)
            fetch('/path/to/historie/files') // Adjust the endpoint to your server setup
                .then(response => response.json())
                .then(files => {
                    files.forEach(file => {
                        // Check if the file contains 'historie' in its name
                        if (file.includes('historie')) {
                            const a = document.createElement('a');
                            a.href = `${historiePath}${file}`;
                            a.textContent = file;
                            dropdownContent.appendChild(a);
                        }
                    });
                })
                .catch(error => {
                    console.error('Error fetching historie files:', error);
                });
        }

        // Call the function to generate the links
        generateHistoryLinks();

        const express = require('express');
const fs = require('fs');
const path = require('path');
const app = express();

app.get('/path/to/historie/files', (req, res) => {
    const directoryPath = path.join(__dirname, 'historie');

    fs.readdir(directoryPath, (err, files) => {
        if (err) {
            return res.status(500).json({ error: 'Unable to scan directory' });
        }

        // Return the list of files as JSON
        res.json(files);
    });
});

app.listen(3000, () => {
    console.log('Server started on http://localhost:3000');
});



        // Functie om inputvelden te kopiëren
        function kopieerInputvelden() {
            const container = document.getElementById('container');
            container.style.display = 'block'; // Zorg ervoor dat de container zichtbaar wordt

            const originalContainer = document.querySelector('.search-container');

            if (!isFirstCloneAdded) {
                // Voeg de eerste clone toe op de plaats van de originele container
                addFirstClone(originalContainer);
                isFirstCloneAdded = true;
            }

            const numCopies = 1; // Aantal kopieën dat je wilt maken

            for (let i = 0; i < numCopies; i++) {
                const newContainer = document.createElement('div');
                newContainer.className = 'search-container';
                newContainer.innerHTML = originalContainer.innerHTML;
                newContainer.style.marginTop = `${(kopieTeller + i + 1) * 150}px`; // Verhoog de margin per kopie

                // Genereer unieke id's voor de gekopieerde inputvelden
                const newSearchId = `search-${kopieTeller + i + 1}`;
                const newHoeveelheidId = `hoeveelheid-${kopieTeller + i + 1}`;
                const newValueDisplayId = `valuedisplay-${kopieTeller + i + 1}`;

                // Update id's van inputvelden en value display
                const newSearchInput = newContainer.querySelector('.search-box');
                const newHoeveelheidInput = newContainer.querySelector('.hoeveelheidbox');
                const newValueDisplay = newContainer.querySelector('.value-display');

                newSearchInput.setAttribute('id', newSearchId);
                newHoeveelheidInput.setAttribute('id', newHoeveelheidId);
                newValueDisplay.setAttribute('id', newValueDisplayId);

                // Voeg event listeners toe voor input velden om de waarde direct bij te werken
                newSearchInput.addEventListener('input', function() {
                    updateValueDisplay(newSearchInput, newHoeveelheidInput, newValueDisplay);
                });

                newHoeveelheidInput.addEventListener('input', function() {
                    updateValueDisplay(newSearchInput, newHoeveelheidInput, newValueDisplay);
                });

                // Voeg gekopieerde container toe aan de hoofdcontainer
                container.appendChild(newContainer);
            }

            // Verberg de originele container na het kopiëren
            originalContainer.style.display = 'none';

            kopieTeller += numCopies;

            // Update het totaal onderaan de pagina na het kopiëren
            updateTotalValueDisplay();
        }

        // Functie om de eerste clone toe te voegen op de plek van de originele container
        function addFirstClone(originalContainer) {
            const newContainer = document.createElement('div');
            newContainer.className = 'search-container';
            newContainer.innerHTML = originalContainer.innerHTML;

            // Genereer unieke id's voor de gekopieerde inputvelden
            const newSearchId = `search-${kopieTeller + 1}`;
            const newHoeveelheidId = `hoeveelheid-${kopieTeller + 1}`;
            const newValueDisplayId = `valuedisplay-${kopieTeller + 1}`;

            // Update id's van inputvelden en value display
            const newSearchInput = newContainer.querySelector('.search-box');
            const newHoeveelheidInput = newContainer.querySelector('.hoeveelheidbox');
            const newValueDisplay = newContainer.querySelector('.value-display');

            newSearchInput.setAttribute('id', newSearchId);
            newHoeveelheidInput.setAttribute('id', newHoeveelheidId);
            newValueDisplay.setAttribute('id', newValueDisplayId);

            // Voeg event listeners toe voor input velden om de waarde direct bij te werken
            newSearchInput.addEventListener('input', function() {
                updateValueDisplay(newSearchInput, newHoeveelheidInput, newValueDisplay);
            });

            newHoeveelheidInput.addEventListener('input', function() {
                updateValueDisplay(newSearchInput, newHoeveelheidInput, newValueDisplay);
            });

            // Voeg gekopieerde container toe aan de hoofdcontainer
            document.getElementById('container').appendChild(newContainer);
        }

        // Functie om totaalwaarde van alle value displays te berekenen en weer te geven
        function updateTotalValueDisplay() {
            let totalValue = 0;
            const allValueDisplays = document.querySelectorAll('.value-display');

            allValueDisplays.forEach(display => {
                const valueText = display.textContent;
                const match = valueText.match(/\d+/); // Zoek naar getallen in de tekst
                if (match) {
                    totalValue += parseInt(match[0]);
                }
            });

            const totalDisplay = document.getElementById('totaal');
            totalDisplay.textContent = `Totaal: ${totalValue} gram`;

            updateNodigValue(totalValue);
        }

        // Functie om de 'nodig' waarde te berekenen en weer te geven
        function updateNodigValue(totalValue) {
            const nodig = 106 - totalValue;
            let scoops = Math.round(nodig / 20);

            // Controleer of scoops 0 of negatief is en corrigeer indien nodig
            if (scoops <= 0) {
                scoops = 1; // Stel scoops in op minimaal 1 als het 0 of negatief is
            }
            const nodigDisplay = document.getElementById('nodig');
            nodigDisplay.textContent = `nodig: ${nodig} gram/${scoops} scoops `;
        }

        // Functie om de ingevulde gegevens te exporteren naar een HTML-bestand
       // Functie om de ingevulde gegevens te exporteren naar een HTML-bestand
       function downloadData() {
    const allSearchInputs = document.querySelectorAll('.search-box');
    const allHoeveelheidInputs = document.querySelectorAll('.hoeveelheidbox');
    const allValueDisplays = document.querySelectorAll('.value-display');

    let data = '<!DOCTYPE html>\n<html>\n<head>\n<title>Mijn Tracker</title>\n</head>\n<body>\n';

    let totalValue = 0;

    for (let i = 0; i < allSearchInputs.length; i++) {
        const searchValue = allSearchInputs[i].value;
        const hoeveelheidValue = allHoeveelheidInputs[i].value;
        const displayValue = allValueDisplays[i].textContent;

        if (searchValue || hoeveelheidValue) {
            const match = displayValue.match(/\d+/);
            if (match) {
                totalValue += parseInt(match[0]);
            }
            data += `<p>${searchValue}, Hoeveelheid: ${hoeveelheidValue}, Totale waarde: ${displayValue}</p>\n`;
        }
    }

    if (data === '<!DOCTYPE html>\n<html>\n<head>\n<title>Mijn Tracker</title>\n</head>\n<body>\n') {
        data += '<p>Geen gegevens ingevuld.</p>\n';
    }

    data += `\n<p>Totaal: ${totalValue} gram</p>\n`;

    // Voeg een knop toe die naar tracker.html gaat
    data += '<a href="tracker.html">Ga naar Tracker</a>\n';

    data += '</body>\n</html>';

    downloadHTML(data);
}

function downloadHTML(htmlContent) {
    const blob = new Blob([htmlContent], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    
    // Huidige datum als bestandsnaam
    const currentDate = new Date();
    const formattedDate = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(currentDate.getDate()).padStart(2, '0')}`;
    a.download = `${formattedDate}.html`;

    a.href = url;
    a.style.display = 'none'; // Verberg de link op de pagina
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}





    </script>
</body>
</html>
